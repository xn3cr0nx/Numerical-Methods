% A: matrice del sistema A*X = b
% b: vettore dei termini noti del sistema A*X = b
% T: matrice T dell'equazione X = T*X + c, estratta con Jacobi
% c: vettore c dell'equazione X = T*X + c, estratto con Jacobi

function [T, c] = Jacobi(A, b)
  disp('Costruzione T con Jacobi')
  n = length(A);
  D = eye(n);
  L = zeros(n);
  U = zeros(n);
  for i=1:n
    fprintf('Iterazione %i\n', i);
    D(i,i) = A(i,i);
    fprintf('D(%i,%i) = A(%i,%i) = %i\n', i, i, i, i, A(i,i))
    for j=i+1:n
      L(j,i) = -A(j,i);
      fprintf('L(%i,%i) = -A(%i,%i) = %i\n', j, i, j, i, -A(j,i))
      U(i,j) = -A(i,j);
      fprintf('L(%i,%i) = -A(%i,%i) = %i\n', i, j, i, j, -A(i,j))
    end
  end
  
  T = inv(D)*(L+U);
  fprintf('T = inv(D)*(L+U) = %i*(%i+%i) = %i\n', inv(D), L, U, inv(D)*(L+U))
  c = inv(D)*b;
  fprintf('c = inv(D)*b = %i',)
end